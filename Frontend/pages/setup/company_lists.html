<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>Company List | Aishalaya</title>
      <link rel="shortcut icon" href="../../assets/images/aishLogo.ico"/>
    
    <!-- plugins:css -->
    <link
      rel="stylesheet"
      href="../../assets/vendors/mdi/css/materialdesignicons.min.css"
    />
    <link
      rel="stylesheet"
      href="../../assets/vendors/css/vendor.bundle.base.css"
    />
    <!-- endinject -->
    <!-- Plugin css for this page -->
    <!-- End Plugin css for this page -->
    <!-- inject:css -->
    <!-- endinject -->
    <!-- Layout styles -->
    <link rel="stylesheet" href="http://127.0.0.1:5500/assets/css/style.css"/>
    <!-- End layout styles -->
    <!--<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">-->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <!--<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>-->
<!--showalert Message-->
<script src="assets/js/alertMessages.js"></script>
   
   
    <style>
      /* Adjust the modal size */
      .modal-dialog {
        max-width: 1100px; /* Set your desired maximum width */
      }

      /* Adjust the form size */
      .form-sample {
        max-width: 100%; /* Set your desired maximum width */
      }
      @media (min-width: 576px) {
        .col-sm-9 {
          -webkit-box-flex: 0;
          -ms-flex: 0 0 auto;
          flex: 0 0 auto;
          width: 100% !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="container-scroller">
      <!-- partial:../../partials/_navbar.html -->
      <nav
        class="navbar default-layout-navbar col-lg-12 col-12 p-0 fixed-top d-flex flex-row"
      >
        <div
          class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-center"
        >
          <a class="navbar-brand brand-logo" href="../../index.html"
            ><img
              src="../../assets/images/logo.png"
              alt="logo"
              style="height: 100%"
          /></a>
          <a class="navbar-brand brand-logo-mini" href="../../index.html"
            ><img
              src="../../assets/images/logo.png"
              alt="logo"
              style="height: 100%"
          /></a>
        </div>
        <div class="navbar-menu-wrapper d-flex align-items-stretch">
          <button
            class="navbar-toggler navbar-toggler align-self-center"
            type="button"
            data-toggle="minimize"
          >
            <span class="mdi mdi-menu"></span>
          </button>
          <ul class="navbar-nav navbar-nav-right">
            <li class="nav-item d-none d-lg-block full-screen-link">
              <a class="nav-link">
                <i class="mdi mdi-fullscreen" id="fullscreen-button"></i>
              </a>
            </li>
            <li class="nav-item nav-logout d-none d-lg-block">
              <a class="nav-link"  onclick="logout()">
                <i class="mdi mdi-power"></i>
              </a>
            </li>
          </ul>
          <button
            class="navbar-toggler navbar-toggler-right d-lg-none align-self-center"
            type="button"
            data-toggle="offcanvas"
          >
            <span class="mdi mdi-menu"></span>
          </button>
        </div>
      </nav>
      <!-- partial -->
      <div class="container-fluid page-body-wrapper">
        <div id="includeHtml"></div>
        <!-- Company Form-->
        <div
          class="modal fade"
          id="companyModal"
          tabindex="-1"
          role="dialog"
          aria-labelledby="companyModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="companyModalLabel">Edit Company</h5>
                <button
                  type="button"
                  class="close"
                  data-dismiss="modal"
                  aria-label="Close"
                  onclick="closeForm()">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>

              <div class="modal-body">
                <!-- Company Form -->
                <form class="form-sample" id="companyForm">
                  <p class="card-description">Company info</p>
                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="companyName">Company Name</label>
                        <div class="col-sm-6">
                          <input class="form-control" type="text" id="companyName" name="companyName" maxlength="50"  oninput="validateInput('companyName')"/>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label
                          class="col-sm-4 col-form-label"
                          for="companyShortName"
                          >Short Name</label
                        >
                        <div class="col-sm-6">
                          <input class="form-control" type="text" id="companyShortName" name="companyShortName" maxlength="50" oninput="validateNo('companyShortName')" />
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="upiNumber"
                          >UPI Number</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="upiNumber" name="upiNumber" class="form-control" maxlength="30"/>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="address1"
                          >Address 1</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="address1" name="address1" class="form-control" maxlength="100" />
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="address2"
                          >Address 2</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="address2" name="address2" class="form-control" maxlength="100"/>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="area"
                          >Area</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="area" name="area" class="form-control"  maxlength="30" oninput="validateNo('area')"/>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Add other company form fields as needed -->

                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="district"
                          >District</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="district" name="district" class="form-control" maxlength="30"oninput="validateInput('district')"/>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="stateCode"
                          >State Code</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="stateCode" name="stateCode" class="form-control" maxlength="2" oninput="validatesInputForStateCode(event)"/>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="gstNo"
                          >GST No</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="gstNo" name="gstNo" class="form-control" maxlength="30" oninput="validateNo('gstNo')" />
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="cinNo"
                          >CIN No</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="cinNo" name="cinNo" class="form-control"  maxlength="30" oninput="validateNo('cinNo')" />
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="pincode"
                          >Pincode</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="pincode" name="pincode" class="form-control" maxlength="6" oninput="validatesInput(event)"/>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="contact"
                          >Contact</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="contact" name="contact" class="form-control" maxlength="12" oninput="validateMobile(event)"/>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="phone"
                          >Phone</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="phone" name="phone" class="form-control" maxlength="12" oninput="validateMobile(event)"/>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="mobile"
                          >Mobile</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="mobile" name="mobile" class="form-control" maxlength="12" oninput="validateMobile(event)"/>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="email"
                          >Email </label
                        >
                        <div class="col-sm-6">
                          <input type="email" id="email" name="email" class="form-control" required />
                          <p id="validationMessage1"></p>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="logo"
                          >Logo</label
                        >
                        <div class="col-sm-3">
                          <img
                            id="logoPreview"
                            src=""
                            
                            style="
                              max-width: 100px;
                              max-height: 100px;
                              margin-top: 5px;
                            "
                          />

                          <input
                            class="form-control"
                            type="file"
                            id="logo"
                            name="logo"
                            style="min-width: 170%; margin-left: -2em"
                            required
                          />
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="signature"
                          >Signature</label
                        >
                        <div class="col-sm-3">
                          <img
                            id="signaturePreview"
                            src=""

                            style="
                              max-width: 100px;
                              max-height: 100px;
                              margin-top: 5px;
                            "
                          />
                          <input
                            class="form-control"
                            type="file"
                            id="signature"
                            name="signature"
                            style="min-width: 170%; margin-left: -2em"
                            required
                          />
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="companySeal"
                          >Company Seal</label
                        >
                        <div class="col-sm-3">
                          <img
                            id="companySealPreview"
                            src=""
                           
                            style="
                              max-width: 100px;
                              max-height: 100px;
                              margin-top: 5px;
                            "
                          />

                          <input
                            class="form-control"
                            type="file"
                            id="companySeal"
                            name="companySeal"
                            style="min-width: 170%; margin-left: -2em"
                            required
                          />
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="salesMail"
                          >Sales Mail </label
                        >
                        <div class="col-sm-6">
                          <input type="email" id="salesMail" name="salesMail" class="form-control" />
                          <p id="validationMessage2"></p>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="panNo"
                          >PAN No</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="panNo" name="panNo" class="form-control" maxlength="30" oninput="validateNo('panNo')"/>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="bankName"
                          >Bank Name</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="bankName" name="bankName" class="form-control"  maxlength="30" oninput="validateInput('bankName')"/>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="accNo"
                          >Account No</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="accNo" name="accNo" class="form-control"  maxlength="30" oninput="validatesAccNoInput(event)"/>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="branchName"
                          >Branch Name</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="branchName" name="branchName" class="form-control" maxlength="30" oninput="validateNo('branchName')"/>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="ifscCode"
                          >IFSC Code</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="ifscCode" name="ifscCode" class="form-control" maxlength="30" oninput="validateNo('ifscCode')"/>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="upiId"
                          >UPI ID</label
                        >
                        <div class="col-sm-6">
                          <input type="text" id="upiId" name="upiId" class="form-control" maxlength="30"/>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Form buttons -->
                  <div class="d-flex justify-content-end">
                    <button
                      type="submit"
                      class="btn btn-gradient-primary me-2"
                      value="submit"
                    >
                      Submit
                    </button>
                    <button
                      type="button"
                      class="btn btn-light"
                      data-dismiss="modal"
                      onclick="closeForm()"
                    >
                      Cancel
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>

        <!-- partial -->
        <div class="main-panel">
          <div class="content-wrapper">
            <div class="page-header">
              <h3 class="page-title">Company List</h3>
              <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="#">Dashboard</a></li>
                  <li class="breadcrumb-item active" aria-current="page">
                    Company List
                  </li>
                </ol>
              </nav>
            </div>
            <div class="row">
              <div class="col-lg-12 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                    <div class="template-demo">
                      <button
                        type="button"
                        class="btn btn-gradient-danger btn-rounded btn-fw"
                        onclick="window.location.href='company_form.html';"
                      >
                        Add New
                      </button>
                    </div>
                    <div class="table-responsive">
                      <table id="dataTable" class="table table-hover">
                        <thead>
                          <tr>
                            <th>Action</th>
                            
                            <th>Company Name</th>
                            <th>Company Shortname</th>
                            <th>Address1</th>
                            <th>Address2</th>
                          </tr>
                        </thead>
                        <tbody>
                          <!-- Your table content -->
                        </tbody>
                      </table>
                    </div>
                    <ul id="pagination" class="pagination"></ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- content-wrapper ends -->
          <div id="includeFooder"></div>
        </div>
        <!-- main-panel ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->

    <!-- plugins:js -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
function logout() {
    // Clear local storage
    localStorage.clear();

    // Replace current state with a new state to prevent going back
    window.history.replaceState(null, "", window.location.href);

    // Add an event listener to handle the popstate event
    window.onpopstate = function (event) {
        // Push another state to forward the user
        window.history.pushState(null, "", window.location.href);
    };

    // Redirect to the logout page or perform other logout actions
    window.location.href = '../../index.html';
   }
let isContentLoaded = false;

document.addEventListener('DOMContentLoaded', async function() {
  if (isContentLoaded) return; // Prevent multiple executions
  isContentLoaded = true;
  try {
    const accessToken = localStorage.getItem('accessToken');
    const employeeEmail = localStorage.getItem('employeeEmail');
    
    // Fetch employee details to get associated company ID
    const responseEmployee = await fetch('http://localhost:8080/api/employee/getEmployeeByEmail/' + employeeEmail, {
      method: 'GET',
      headers: {
        'Authorization': accessToken
      },
    });
    if (!responseEmployee.ok) {
      throw new Error('Failed to fetch employee details');
    }

    const dataEmployee = await responseEmployee.json();

    // Ensure that the company object and companyId are properly fetched
    if (!dataEmployee.company || !dataEmployee.company.companyId) {
      throw new Error('Company ID not found in employee details');
    }
    const companyId = dataEmployee.company.companyId;

    // Fetch company details based on companyId
    fetchCompanyDetails(companyId);
  } catch (error) {
    console.error('Error:', error);
    // Handle error
  }
});



      function logout() {
        // Clear local storage
        localStorage.clear();
        
        // Redirect to the logout page or perform other logout actions
        window.location.href = '../../index.html';
    }


      function closeForm() {
        // Assuming 'employeeModal' is the ID of your modal
        $("#companyModal").modal("hide");
      }
      function fetchCompanyDetails(companyId) {
  const accessToken = localStorage.getItem('accessToken');
  const MainMenus = localStorage.getItem('MainMenus');

// Check permissions
const canView = MainMenus && MainMenus.includes('Company List View');
  $.ajax({
    url: `http://localhost:8080/api/company/getCompanyById/${companyId}`,
    type: "GET",
    dataType: "json",
    headers: {
      'Content-Type': 'application/json',
      'Authorization': accessToken,
    },
    success: function(data) {
      // Populate table with fetched data
      $("#dataTable tbody").empty(); // Clear existing data

      var status = data.isActive == 1 ? "Active" : "Inactive";

      let buttons = '';

                if (canView) {
                    buttons += `
                        <button type="button" class="btn btn-info btn-sm view-btn" data-toggle="modal" data-target="#companyModal" data-company-id="${data.companyId}">View</button>
                    `;
                }
      $("#dataTable tbody").append(`
        <tr>
          <td>${buttons}</td>
          <td>${data.companyName}</td>
          <td>${data.companyShortName}</td>
          <td>${data.address1}</td>
          <td>${data.address2}</td>
        </tr>
      `);

      $("#companyModal").modal("hide");
    },
    error: function(xhr, status, error) {
      console.error(xhr.responseText); // Log the error response
      console.error(error); // Log the error message
      showalert("Error fetching data from the server. Please try again later."); // Display an error message to the user
    },
  });
}

        var currentCompanyId;

        $(document).on("click", ".edit-btn", function () {
          currentCompanyId = $(this).data("company-id");
          var companyId = $(this).data("company-id");
          console.log(companyId);
          const accessToken = localStorage.getItem('accessToken');
          $.ajax({
            url:
              "http://localhost:8080/api/superAdmin/getCompanyById/" +
              companyId,
            type: "GET",
            dataType: "json",
            headers: {
              'Content-Type': 'application/json',
              'Authorization': accessToken,
            },
            success: function (companyData) {
              populateCompanyForm(companyData);
              document.body.scrollTop = 0; // For Safari
              document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE, and Opera
              $("#companyModal").modal("show");
            },
            error: function (xhr, status, error) {
              console.error(xhr.responseText);
              console.error(error);
              showalert("Error fetching company details. Please try again later.");
            },
          });
        });

        function populateCompanyForm(companyData, formData) {
          // const logoPreview = document.getElementById('logoPreview');
          //const signaturePreview = document.getElementById('signaturePreview');
          //const companySealPreview = document.getElementById('companySealPreview');

          //const formattedPincode = companyData.pincode ? companyData.pincode.toString() : '';

          console.log(companyData.companyName, "shan");
          $("#companyName").val(companyData.companyName);
          $("#companyShortName").val(companyData.companyShortName);
          $("#address1").val(companyData.address1);
          $("#address2").val(companyData.address2);
          $("#area").val(companyData.area);
          $("#district").val(companyData.district);
          $("#stateCode").val(companyData.stateCode);
          $("#gstNo").val(companyData.gstNo);
          $("#cinNo").val(companyData.cinNo);
          $("#pincode").val(companyData.pincode);
          $("#contact").val(companyData.contact);
          $("#phone").val(companyData.phone);
          $("#mobile").val(companyData.mobile);
          $("#email").val(companyData.email);
          $("#salesMail").val(companyData.salesMail);
          $("#panNo").val(companyData.panNo);
          $("#bankName").val(companyData.bankName);
          $("#accNo").val(companyData.accNo);
          $("#branchName").val(companyData.branchName);
          $("#ifscCode").val(companyData.ifscCode);
          $("#upiId").val(companyData.upiId);
          $("#upiNumber").val(companyData.upiNumber);

          const signPreview = document.getElementById("signaturePreview");

          if (signPreview) {
            // Display the avatar image using the File API
            const signatureFileInput = document.getElementById("signature");

            if (signatureFileInput.files.length > 0) {
              const reader = new FileReader();

              reader.onload = function (e) {
                console.log("Image loaded successfully");
                signPreview.src = e.target.result;
              };

              reader.readAsDataURL(signatureFileInput.files[0]);
            }
          }

          const SealPreview = document.getElementById("companySealPreview");
          if (SealPreview) {
            // Display the avatar image using the File API
            const companySealFileInput = document.getElementById("companySeal");

            if (companySealFileInput.files.length > 0) {
              const reader = new FileReader();

              reader.onload = function (e) {
                console.log("Image loaded successfully");
                SealPreview.src = e.target.result;
              };

              reader.readAsDataURL(companySealFileInput.files[0]);
            }
          }

          const logosPreview = document.getElementById("logoPreview");
          if (logosPreview) {
            // Display the avatar image using the File API
            const logoFileInput = document.getElementById("logo");

            if (logoFileInput.files.length > 0) {
              const reader = new FileReader();

              reader.onload = function (e) {
                console.log("Image loaded successfully");
                logosPreview.src = e.target.result;
              };

              reader.readAsDataURL(logoFileInput.files[0]);
            }
          }
        }

        document
          .getElementById("companyForm")
          .addEventListener("submit", async function (event) {
            event.preventDefault();
            const formData = new FormData();
            var companyId = currentCompanyId;

            const companyData = {
              companyName: document.getElementById("companyName").value,
              companyShortName:
                document.getElementById("companyShortName").value,
              address1: document.getElementById("address1").value,
              address2: document.getElementById("address2").value,
              area: document.getElementById("area").value,
              district: document.getElementById("district").value,
              stateCode: document.getElementById("stateCode").value,
              gstNo: document.getElementById("gstNo").value,
              cinNo: document.getElementById("cinNo").value,
              pincode: document.getElementById("pincode").value,
              contact: document.getElementById("contact").value,
              phone: document.getElementById("phone").value,
              mobile: document.getElementById("mobile").value,
              email: document.getElementById("email").value,
              salesMail: document.getElementById("salesMail").value,
              panNo: document.getElementById("panNo").value,
              bankName: document.getElementById("bankName").value,
              accNo: document.getElementById("accNo").value,
              branchName: document.getElementById("branchName").value,
              ifscCode: document.getElementById("ifscCode").value,
              upiId: document.getElementById("upiId").value,
              upiNumber: document.getElementById("upiNumber").value,
            };

            formData.append(
              "company",
              new Blob([JSON.stringify(companyData)], {
                type: "application/json",
              })
            );

            const logoFileInput = document.getElementById("logo");
            const signatureFileInput = document.getElementById("signature");
            const companySealFileInput = document.getElementById("companySeal");

            if (logoFileInput.files.length > 0) {
              formData.append("logo", logoFileInput.files[0]);
            }

            if (signatureFileInput.files.length > 0) {
              formData.append("signature", signatureFileInput.files[0]);
            }

            if (companySealFileInput.files.length > 0) {
              formData.append("companySeal", companySealFileInput.files[0]);
            }

            const accessToken = localStorage.getItem('accessToken');
            $.ajax({
              url:
                "http://localhost:8080/api/superAdmin/company/editCompany/" +
                currentCompanyId,
              type: "PUT",
              data: formData,
              processData: false,
              contentType:  false,
              headers: {
              'Authorization': accessToken,
            },
              success: function (response) {
                console.log("Company updated successfully:", response);
               
                showalert("Company Details updated successfully",function(){
                window.location.href = "company_list.html";
                });
              },
              error: function (xhr, status, error) {
                console.error("Error updating company:", error);
                showalert("Error updating company. Please try again.");
              },
            });
          });
      

      const emailInputs = document.querySelectorAll('input[type="email"]');
    const validationMessages = [
        document.getElementById('validationMessage1'),
        document.getElementById('validationMessage2')
    ];
    // Regular expression to validate email addresses for the specified domains
    const emailRegex = /^[a-zA-Z0-9._%+-]+@(gmail\.com|yahoo\.com|outlook\.com|hotmail\.com|aol\.com|icloud\.com|protonmail\.com|zoho\.com|gmx\.com|yandex\.com|mail\.com)$/;

    emailInputs.forEach((input, index) => {
        input.addEventListener('input', () => {
            validateEmail(input, validationMessages[index]);
        });
    });

    function validateEmail(emailInput, validationMessage) {
        const email = emailInput.value;

        if (emailRegex.test(email)) {
            validationMessage.innerText = "Valid email address";
            validationMessage.style.color = "green";
        } else {
            validationMessage.innerText = "Invalid email address";
            validationMessage.style.color = "red";
        }
    }



document.getElementById('submit').addEventListener('click', submitForm);

function submitForm(event) {
    event.preventDefault(); // Prevent default form submission behavior
    
    // Validate both fields
    validateNo('companyShortName');
    validateNo('area');
    validateNo('ifscCode');
    validateNo('branchName');
    validateNo('accNo');
    validateNo('panNo');
    validateNo('cinNo');
    validateNo('gstNo');
}
function validateNo(inputId) {
    const inputField = document.getElementById(inputId);
    const inputValue = inputField.value;
    const NoRegex = /^[A-Za-z0-9\s]*$/; // Regular expression to allow alphabets, numbers, and spaces

    if (!NoRegex.test(inputValue)) {
        inputField.style.borderColor = 'red'; // Set border color to red
        inputField.setCustomValidity("Please enter numbers and alphabets only."); // Set custom validation message
        inputField.reportValidity(); // Show validation message
    } else {
        inputField.style.borderColor = ''; // Reset border color
        inputField.setCustomValidity(""); // Clear custom validation message
    }
}


document.getElementById('submit').addEventListener('click', submitForm);

function submitForm(event) {
    event.preventDefault(); // Prevent default form submission behavior
    validateInput('companyName');
    validateInput('branchName');
}

function validateInput(inputId) {
    const inputValue = document.getElementById(inputId).value;
    const alphaRegex = /^[a-zA-Z\s]+$/; // Regular expression to match only alphabetic characters and spaces
    const specialCharRegex = /[^a-zA-Z\s]/; // Regular expression to match any special characters
    
    if (specialCharRegex.test(inputValue) || !alphaRegex.test(inputValue)) {
        document.getElementById(inputId).style.borderColor = 'red'; // Set border color to red
        document.getElementById(inputId).setCustomValidity("Only alphabetic characters are allowed."); // Set validation message
        document.getElementById(inputId).reportValidity(); // Show validation message
    } else {
        document.getElementById(inputId).style.borderColor = ''; // Reset border color
        document.getElementById(inputId).setCustomValidity(""); // Clear validation message
    }
}

function validatesInput(event) {
    const inputValue = event.target.value;
    const numericRegex = /^[0-9]*$/; // Regular expression to match numeric characters

    if (!numericRegex.test(inputValue)) {
        event.target.style.borderColor = 'red'; // Set border color to red
        event.target.setCustomValidity("Only numeric characters are allowed."); // Set validation message
        event.target.reportValidity(); // Show validation message
        event.target.value = inputValue.replace(/\D/g, ''); // Remove non-numeric characters
    } else if (inputValue.length < 6) {
        event.target.style.borderColor = 'red'; // Set border color to red
        event.target.setCustomValidity("Minimum length is 6 digits."); // Set validation message
        event.target.reportValidity(); // Show validation message
    } else if (inputValue.length > 6) {
        event.target.style.borderColor = 'red'; // Set border color to red
        event.target.setCustomValidity("Maximum length is 6 digits."); // Set validation message
        event.target.reportValidity(); // Show validation message
        event.target.value = inputValue.slice(0, 6); // Truncate to 6 digits
    } else {
        event.target.style.borderColor = ''; // Reset border color
        event.target.setCustomValidity(""); // Clear validation message
    }
}


function validatesAccNoInput(event) {
    const inputValue = event.target.value;
    const numericRegex = /^[0-9]*$/; // Regular expression to match numeric characters

    if (!numericRegex.test(inputValue)) {
        event.target.style.borderColor = 'red'; // Set border color to red
        event.target.setCustomValidity("Only numeric characters are allowed."); // Set validation message
        event.target.reportValidity(); // Show validation message
    } else {
        event.target.style.borderColor = ''; // Reset border color
        event.target.setCustomValidity(""); // Clear validation message
    }
}



function validateMobile(event) {
    const inputValue = event.target.value;
    const numericRegex = /^[0-9]*$/; // Regular expression to match numeric characters

    if (!numericRegex.test(inputValue)) {
        event.target.style.borderColor = 'red'; // Set border color to red
        event.target.setCustomValidity("Only numeric characters are allowed."); // Set validation message
        event.target.reportValidity(); // Show validation message
        event.target.value = inputValue.replace(/\D/g, ''); // Remove non-numeric characters
    } else if (inputValue.length > 12) {
        event.target.style.borderColor = 'red'; // Set border color to red
        event.target.setCustomValidity("Maximum length for mobile number is 12 digits."); // Set validation message
        event.target.reportValidity(); // Show validation message
        event.target.value = inputValue.slice(0, 12); // Truncate to 12 digits
    } else {
        event.target.style.borderColor = ''; // Reset border color
        event.target.setCustomValidity(""); // Clear validation message
    }
}

function validatesInputForStateCode(event) {
          const inputValue = event.target.value;
          const numericRegex = /^[0-9]*$/; // Regular expression to match numeric characters
      
          if (!numericRegex.test(inputValue)) {
            showalert("Only numeric characters are allowed.");
            event.target.value = inputValue.replace(/\D/g, ''); // Remove non-numeric characters
          }
      
          if (inputValue.length > 2) {
            showalert("Maximum length is 2 digits.");
            event.target.value = inputValue.slice(0, 2); // Truncate to 6 digits
          }
        }



    </script>
    <!-- plugins:js -->
  <script src="../../assets/vendors/js/vendor.bundle.base.js"></script></script>
 */
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <script src="../../assets/vendors/chart.js/Chart.min.js"></script>
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="../../assets/js/off-canvas.js"></script>
    <script src="../../assets/js/hoverable-collapse.js"></script>
    <!-- <script src="../../assets/js/pagination.js"></script> -->
    <script src="../../assets/js/menu_active.js"></script>
    <script src="../../assets/js/misc.js"></script>
    <!-- endinject -->
    <!-- Custom js for this page -->
    <script src="../../assets/js/chart.js"></script>
    <!-- End custom js for this page -->
  </body>
</html>